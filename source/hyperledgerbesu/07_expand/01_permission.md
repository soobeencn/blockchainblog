## 准入机制

### 背景
现状:
- 当下区块链环境是多节点部署到同一专有网络中, 这样没有发挥区块链共识机制的作用

为什么要接入准入机制:
- 多家机构共同参与共识,共同治理区块链网络,以达到安全、防篡改的目的.

### 目标
1. 节点加入准入机制;
2. 添加账户权限, 服务端与节点建立通信, 需要特定账户, 必须使用密钥.

### 方案

#### 网络配置
配置网络，以确保永远不会丢失1/3或更多验证器。如果超过1/3的验证器停止参与，则不再创建新块，网络将停滞。一旦节点重新启动，恢复可能需要很长时间。

最低节点数量: 4

最高节点数量: 32 

#### 整体架构
// 补充

_关于许可：许可型网络通过启用 **节点许可** 或 **帐户许可**，只允许指定的 **节点** 和 **帐户** 参与._

#### 节点许可                

- 确认节点数量,比如4个,这里的节点与机构(医院)对等
- 生成key和pubkey密钥文件

    ```
    ├── genesis.json
    └── keys
        ├── 0x4c1cac51f35d844fbcdcd39e58607bad9220da57
        │   ├── key
        │   └── key.pub
        ├── 0xac859b0fc658f326fa39e0fac1dd085c05e1ecd4
        │   ├── key
        │   └── key.pub
        ├── 0xd56107077aca91e0f8e792a42816aeb38d0d9f52
        │   ├── key
        │   └── key.pub
        └── 0xed176a37eef24de4affee204a1a89f0103d25dad
            ├── key
            └── key.pub
    ```
- 将4个节点分发至各个机构中, 比如: /Node-1/data/ 目录下              
- 启动任一节点, 启动后生成引导节点, 后续节点采取连接引导节点的方式启动
- 最后查看每个节点的日志, 判断是否参与共识.

备注: 只有通过同一genesisFile生成的密钥, 分发到机构中, 节点才可以参与到共识网络中.

#### 账户许可
- 现有: 
    - 当下账户转账(存证事务),不需要消耗gas, 也就是创建一个账户(account和privateKey)即可发起交易, 并会被节点识别并打包至区块中,并广播至全网.

- 修改: 
    - 节点启动时禁止使用命令: --min-gas-price=0
    - 创世区块中配置alloc账户及余额,使用genesis.json初始化后,删除alloc账户信息,确保安全,选择外部账户管理器进行管理授权
    - 交易设置: 
        - gasPrice=0L --> gasPrice=21000
    -  创建账户管理器, 管理账户
        1. 创建钱包 --> 根据助记词生成account与privateKey --> 记录
        2. 授权新的account
        3. 获取授权状态
        4. 通过新的account, 发起交易(事务:存证、取证、区块信息、交易信息)

-------------------------------------------

